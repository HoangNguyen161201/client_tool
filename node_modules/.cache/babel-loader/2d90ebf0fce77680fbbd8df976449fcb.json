{"ast":null,"code":"import _objectSpread from\"C:/Users/hoang/OneDrive/M\\xE1y t\\xEDnh/learnWeb/reactjs/memories_project/client/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import React from'react';import{Link,useLocation as UseLocation,useHistory as UseHistory}from'react-router-dom';import{Formik,Form,Field,ErrorMessage}from'formik';import*as yup from'yup';import inputField from'../../../conFigForm/inputField';import selectField from'../../../conFigForm/selectField';import fileField from'../../../conFigForm/fileField';import{useDispatch as UseDispatch,useSelector as UseSelector}from'react-redux';import postAction from'../../../redux/actions/index';import{POSTFILE,POST}from'../../../api/index';import fileAction from'../../../redux/actions/file';import{useEffect as UseEffect}from'react';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function updatePost(){var dataPosts=UseSelector(function(state){return state.post;}).data;function UseQuery(){return new URLSearchParams(UseLocation().search);}var query=UseQuery();var idPost=query.get('idPost');var dataUpdate={};dataPosts.map(function(e){if(e._id===idPost){dataUpdate=e;return e;}return 0;});var dispatch=UseDispatch();var history=UseHistory();var getfile=UseSelector(function(state){return state.saveFile;});var getDlCt=UseSelector(function(state){return state.categories;}).data;var check=yup.object({title:yup.string().required('Not null'),link:yup.string().url('It is not the link').required('Not null'),content:yup.string().required('Not null')});UseEffect(function(){dispatch(fileAction.resetFile());},[]);return/*#__PURE__*/_jsx(\"div\",{className:\"container-sm\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"container-sm\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"row justify-content-center \",children:/*#__PURE__*/_jsxs(\"div\",{className:\"p-0 col-12 col-sm-8 col-lg-6 d-flex justify-content-between align-items-center\",children:[/*#__PURE__*/_jsx(\"p\",{style:{color:'#4a50c0',fontWeight:'500'},className:\"mt-4 text-center fs-4\",children:\"Add new tool\"}),/*#__PURE__*/_jsx(Link,{to:\"/post\",className:\"btn btn-primary\",children:\"Back\"})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"row justify-content-center \",children:/*#__PURE__*/_jsx(Formik,{initialValues:{title:dataUpdate.title,content:dataUpdate.content,link:dataUpdate.link,id_category:dataUpdate.id_category,img:''},validationSchema:check,validate:function validate(value){var error={};if(!value.img.toLowerCase().endsWith('.png')&&!value.img.toLowerCase().endsWith('.jpg')&&!value.img.toLowerCase().endsWith('.jpeg')&&!value.img.toLowerCase().endsWith('.gif')&&value.img){error.img='khong phai image';}return _objectSpread({},error);},onSubmit:function onSubmit(values,_ref){var setSubmitting=_ref.setSubmitting;setTimeout(function(){var r=new FormData();r.append('file',getfile.file);var dataUpdate=_objectSpread({},values);dataUpdate.img=getfile.file.name;dataUpdate._id=String(idPost);POSTFILE('/post/update',r);POST('/post/update',dataUpdate).then(function(e){dispatch(postAction.update(e));history.push('/post');});setSubmitting(false);},400);},children:function children(_ref2){var isSubmitting=_ref2.isSubmitting;return/*#__PURE__*/_jsxs(Form,{className:\"p-4 mt-3 border shadow-sm col-12 col-sm-8 col-lg-6 border-primary rounded-2\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"mb-3\",children:[/*#__PURE__*/_jsx(Field,{name:\"title\",type:\"text\",placeholder:\"enter title\",label:\"Title\",component:inputField}),/*#__PURE__*/_jsx(ErrorMessage,{className:\"form-text\",style:{color:'red'},name:\"title\",component:\"small\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\" row row-cols-1 row-cols-sm-2\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"col\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"mb-3\",children:[/*#__PURE__*/_jsx(Field,{name:\"link\",type:\"url\",placeholder:\"enter link\",label:\"Link\",component:inputField}),/*#__PURE__*/_jsx(ErrorMessage,{className:\"form-text\",style:{color:'red'},name:\"link\",component:\"small\"})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"col\",children:/*#__PURE__*/_jsx(\"div\",{className:\"mb-3\",children:/*#__PURE__*/_jsx(Field,{name:\"id_category\",data:getDlCt,label:\"Category\",component:selectField})})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-3\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"content\",className:\"form-label\",children:\"Content\"}),/*#__PURE__*/_jsx(Field,{component:\"textarea\",className:\"form-control\",name:\"content\",id:\"content\"}),/*#__PURE__*/_jsx(ErrorMessage,{className:\"form-text\",style:{color:'red'},name:\"content\",component:\"small\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-3\",children:[/*#__PURE__*/_jsx(Field,{name:\"img\",type:\"file\",id:\"file\",label:\"Insert image\",component:fileField}),/*#__PURE__*/_jsx(ErrorMessage,{className:\"form-text\",style:{color:'red'},name:\"img\",component:\"small\"})]}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",disabled:isSubmitting,className:\"mb-2 btn btn-primary\",children:\"Submit\"})]});}})})]})});}export default updatePost;","map":{"version":3,"sources":["C:/Users/hoang/OneDrive/Máy tính/learnWeb/reactjs/memories_project/client/src/features/post/pages/updatePost.js"],"names":["React","Link","useLocation","UseLocation","useHistory","UseHistory","Formik","Form","Field","ErrorMessage","yup","inputField","selectField","fileField","useDispatch","UseDispatch","useSelector","UseSelector","postAction","POSTFILE","POST","fileAction","useEffect","UseEffect","updatePost","dataPosts","state","post","data","UseQuery","URLSearchParams","search","query","idPost","get","dataUpdate","map","e","_id","dispatch","history","getfile","saveFile","getDlCt","categories","check","object","title","string","required","link","url","content","resetFile","color","fontWeight","id_category","img","value","error","toLowerCase","endsWith","values","setSubmitting","setTimeout","r","FormData","append","file","name","String","then","update","push","isSubmitting"],"mappings":"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","sourcesContent":["import React from 'react'\r\nimport { Link , useLocation as UseLocation, useHistory as UseHistory} from 'react-router-dom';\r\nimport { Formik, Form, Field, ErrorMessage } from 'formik';\r\nimport * as yup from 'yup';\r\nimport inputField from '../../../conFigForm/inputField';\r\nimport selectField from '../../../conFigForm/selectField';\r\nimport fileField from '../../../conFigForm/fileField';\r\nimport {useDispatch as UseDispatch, useSelector as UseSelector} from 'react-redux';\r\nimport postAction from '../../../redux/actions/index';\r\nimport {POSTFILE, POST} from '../../../api/index';\r\nimport fileAction from '../../../redux/actions/file';\r\nimport {useEffect as UseEffect} from 'react';\r\nfunction updatePost() {\r\n    var dataPosts = UseSelector(state=>state.post).data;\r\n    function UseQuery() {\r\n        return new URLSearchParams(UseLocation().search);\r\n    }\r\n    const query = UseQuery();\r\n    const idPost = query.get('idPost');\r\n    var dataUpdate = {};\r\n    \r\n     dataPosts.map(e=>{\r\n        if(e._id === idPost){\r\n            dataUpdate = e;\r\n            return e;\r\n        }\r\n        return 0;\r\n    });\r\n\r\n\r\n\r\n    const dispatch = UseDispatch();\r\n    const history = UseHistory();\r\n    const getfile = UseSelector(state=>state.saveFile);\r\n    const getDlCt = UseSelector(state=>state.categories).data;\r\n\r\n\r\n    const check = yup.object({\r\n        title: yup.string().required('Not null'),\r\n        link: yup.string().url('It is not the link').required('Not null'),\r\n        content: yup.string().required('Not null'),\r\n    });\r\n    \r\n    UseEffect(()=>{\r\n        dispatch(fileAction.resetFile()); \r\n    },[]);\r\n\r\n    \r\n    return (\r\n<div className='container-sm'>\r\n            <div className='container-sm'>\r\n\r\n                <div className='row justify-content-center '>\r\n                    <div className='p-0 col-12 col-sm-8 col-lg-6 d-flex justify-content-between align-items-center'>\r\n                        <p style={{ color: '#4a50c0', fontWeight: '500' }} className='mt-4 text-center fs-4'>Add new tool</p>\r\n                        <Link to='/post' className='btn btn-primary'>Back</Link>\r\n                    </div>\r\n                </div>\r\n                <div className='row justify-content-center '>\r\n                    <Formik\r\n                        initialValues={{\r\n                            title: dataUpdate.title,\r\n                            content: dataUpdate.content,\r\n                            link: dataUpdate.link,\r\n                            id_category: dataUpdate.id_category,\r\n                            img: ''\r\n                        }}\r\n                        validationSchema = {check}\r\n                        validate = {value=>{\r\n                            const error = {};\r\n                            if(\r\n                                !value.img.toLowerCase().endsWith('.png') &&\r\n                                !value.img.toLowerCase().endsWith('.jpg') &&\r\n                                !value.img.toLowerCase().endsWith('.jpeg') &&\r\n                                !value.img.toLowerCase().endsWith('.gif') &&\r\n                                value.img\r\n                            ){\r\n                                error.img = 'khong phai image';\r\n                            }\r\n                            return {\r\n                                ...error\r\n                            }\r\n                        }}\r\n                        onSubmit={(values, { setSubmitting }) => {\r\n                            setTimeout(() => {\r\n                                const r = new FormData();\r\n                                r.append('file',getfile.file);\r\n\r\n                                var dataUpdate = {...values};\r\n                                dataUpdate.img = getfile.file.name;\r\n                                dataUpdate._id = String(idPost);\r\n                                POSTFILE('/post/update',r);\r\n                                POST('/post/update',dataUpdate).then(e=>{\r\n                                    dispatch(postAction.update(e));\r\n                                    history.push('/post');\r\n                                });\r\n                                setSubmitting(false);\r\n                            }, 400);\r\n                        }}\r\n                    >\r\n                        {({ isSubmitting }) => (\r\n                            <Form className='p-4 mt-3 border shadow-sm col-12 col-sm-8 col-lg-6 border-primary rounded-2'>\r\n                                <div className=\"mb-3\">\r\n                                    <Field name='title' type='text' placeholder='enter title' label='Title' component={inputField} />\r\n                                    <ErrorMessage className=\"form-text\" style={{color: 'red'}} name='title' component='small'/>\r\n                                </div>\r\n                                <div className=\" row row-cols-1 row-cols-sm-2\">\r\n                                    <div className='col'>\r\n                                        <div className=\"mb-3\">\r\n                                            <Field name='link' type='url' placeholder='enter link' label='Link' component={inputField} />\r\n                                            <ErrorMessage className=\"form-text\" style={{color: 'red'}} name='link' component='small'/>\r\n                                        </div>\r\n                                    </div>\r\n                                    <div className='col'>\r\n                                        <div className=\"mb-3\">\r\n                                            <Field name='id_category' data={getDlCt} label='Category' component={selectField} />\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n                                <div className=\"mb-3\">\r\n                                    <label htmlFor=\"content\" className=\"form-label\">Content</label>\r\n                                    <Field component='textarea' className=\"form-control\" name='content' id='content' />\r\n                                    <ErrorMessage className=\"form-text\" style={{color: 'red'}} name='content' component='small'/>\r\n                                </div>\r\n                                <div className=\"mb-3\">\r\n                                    <Field name='img' type='file' id='file' label='Insert image' component={fileField} />\r\n                                    <ErrorMessage className=\"form-text\" style={{color: 'red'}} name='img' component='small'/>\r\n                                </div>\r\n                                <button type=\"submit\" disabled={isSubmitting} className=\"mb-2 btn btn-primary\">Submit</button>\r\n                            </Form>\r\n\r\n                        )}\r\n                    </Formik>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    )\r\n}\r\n\r\n\r\n\r\nexport default updatePost\r\n\r\n"]},"metadata":{},"sourceType":"module"}